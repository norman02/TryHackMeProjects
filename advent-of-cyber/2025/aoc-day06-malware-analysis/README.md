
# üéÑ Advent of Cyber 2025 ‚Äì Day 6  
## Malware Analysis ‚Äì Egg-xecutable

**Difficulty:** Medium  
**Focus:** Introductory malware analysis (static + dynamic)  
**Perspective:** SOC / DFIR / Blue Team  
**Sample:** HopHelper.exe  
**Environment:** Isolated sandbox VM (TryHackMe analyst machine)

---

## üß† Objective

Learn the fundamentals of malware analysis by safely examining a suspicious executable to understand:

- what the file is
- what it contains
- how it behaves when executed
- how it persists
- how it communicates over the network

The goal is **defensive understanding**, not reverse engineering for exploitation.

---

## üß≠ Analyst Principles

### Golden Rule
> **Never run malware on systems you care about.**

All execution must occur inside:
- sandboxes
- virtual machines
- disposable environments

---

## üîç Malware Analysis Overview

Malware analysis is split into two complementary approaches:

| Method | Purpose |
|-----|-----|
| Static Analysis | Inspect the file without running it |
| Dynamic Analysis | Execute the file to observe real behavior |

Both are required for accurate conclusions.

---

# PART 1 ‚Äî Static Analysis (No Execution)

> ‚ö†Ô∏è Do **not** execute HopHelper.exe yet

Static analysis provides **early intelligence** without risk.

---

## 1Ô∏è‚É£ Identify the Sample (SHA256)

### Tool
**PeStudio**

### Steps
1. Launch **PeStudio**
2. Load `HopHelper.exe`  
   (Desktop ‚Üí HopHelper folder)
3. Navigate to:
```

Indicators ‚Üí File ‚Üí SHA256

```

### Why This Matters
- SHA256 uniquely identifies the sample
- Used for:
- threat intelligence
- IOC tracking
- incident correlation

üìå **Answer:** SHA256Sum of HopHelper.exe

---

## 2Ô∏è‚É£ Inspect Strings

### Steps
1. In PeStudio, click **Strings**
2. Wait for analysis to complete
3. Scroll toward the bottom

### What to Look For
Readable artifacts such as:
- IP addresses
- URLs
- commands
- flags

### Why Strings Matter
Attackers often leave:
- hardcoded infrastructure
- debug artifacts
- operational mistakes

üìå A flag with the format:
```

THM{XXXXX}

```
appears in the strings output.

üìå **Answer:** Flag value from strings

---

# PART 2 ‚Äî Dynamic Analysis (Controlled Execution)

Dynamic analysis reveals **actual runtime behavior**.

---

## 3Ô∏è‚É£ Baseline the Registry (Regshot)

### Tool
**Regshot**

### Steps
1. Launch Regshot
2. Set output directory to Desktop
3. Click:
```

1st shot ‚Üí Shot

```

### Purpose
Establish a **clean baseline** to detect changes caused by malware.

---

## 4Ô∏è‚É£ Execute the Sample

### Steps
1. Navigate to:
```

Desktop ‚Üí HopHelper ‚Üí HopHelper.exe

```
2. Execute the file

### Expected Behavior
- No obvious output
- Possible UI oddities
- Silent execution

This is typical of real malware.

---

## 5Ô∏è‚É£ Capture Registry Changes

### Steps
1. Return to Regshot
2. Click:
```

2nd shot ‚Üí Shot

```
3. Click:
```

Compare

```

### Analysis
Search the results for:
```

CurrentVersion\Run

```

### Important Distinction
- **Execution artifacts** (e.g., BAM keys) only show that malware ran
- **Persistence mechanisms** ensure malware runs again

üìå Correct persistence indicators include:
```

HKCU\Software\Microsoft\Windows\CurrentVersion\Run
HKLM\Software\Microsoft\Windows\CurrentVersion\Run

```

üìå **Answer:** Full registry path of the persistence key modified by HopHelper.exe

---

# PART 3 ‚Äî Runtime Behavior (ProcMon)

---

## 6Ô∏è‚É£ Monitor Process Activity

### Tool
**Process Monitor (ProcMon)**

### Steps
1. Launch ProcMon
2. Let it begin capturing
3. Execute HopHelper.exe again
4. Wait ~1 minute
5. Stop capture

---

## 7Ô∏è‚É£ Filter by Process

### Filter
```

Process Name | is | HopHelper.exe

```

This removes unrelated system noise.

---

## 8Ô∏è‚É£ Filter Network Activity

### Filter
```

Operation | contains | TCP

```

### What to Observe
- TCP Connect
- TCP Send / Receive
- Destination ports and behavior

### Purpose
Identify the **network protocol** used by the malware.

üìå **Answer:** Network protocol used by HopHelper.exe

---

## ‚≠ê Bonus ‚Äî Identify the Web Panel (C2)

### Analyst Logic
Most malware communicates with:
- a command-and-control (C2) server
- often via HTTP or raw TCP

### How to Find It
Combine:
- **PeStudio strings** (URLs, IPs)
- **ProcMon network events** (destination IPs)

Matching endpoints indicate the malware‚Äôs web panel.

---

## üß† Key Lessons Learned

- Always perform static analysis before execution
- Execution artifacts ‚â† persistence mechanisms
- Registry Run keys indicate survivability
- Network behavior enables containment
- Malware analysis focuses on **defensive outcomes**

---

## üß≠ Skills Practiced

- Static malware triage
- IOC extraction
- Windows registry analysis
- Persistence detection
- Network behavior analysis
- SOC / DFIR workflow discipline

---

## ‚ö†Ô∏è Ethical Note

All analysis was performed:
- in an isolated sandbox
- against intentionally vulnerable samples
- for defensive learning purposes

Unauthorized malware execution or analysis outside controlled environments is unsafe and unethical.

---

## üîó Related Learning
- TryHackMe: Basic Static Analysis
- TryHackMe: Basic Dynamic Analysis
- Windows Persistence Techniques
- SOC Incident Response Workflows


