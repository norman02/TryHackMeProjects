
# Penetration Test Report – RootMe CTF (TryHackMe)

## Executive Summary
The **RootMe CTF** environment was assessed to identify common misconfigurations and vulnerabilities.  
During the engagement, two critical issues were identified:

1. **File Upload Bypass** – Weak filtering allowed arbitrary code execution by uploading a `.php5` file.  
2. **Privilege Escalation via SUID Binary** – `/usr/bin/python` was incorrectly configured with the SUID bit, allowing full root compromise.

Both the **user** and **root** flags were obtained, demonstrating end-to-end exploitation from external attack to full system takeover.

---

## Scope
- **Target:** rootme.thm (10.10.227.19)  
- **Services Identified:**  
  - SSH (22)  
  - HTTP (80, Apache 2.4.41)  

---

## Findings

### 1. Arbitrary File Upload (Critical)
- **Description:**  
  The web application at `/panel/` included an upload form. Standard PHP files (`.php`) were blocked, but changing the extension to `.php5` bypassed validation.  
- **Impact:**  
  Allowed remote attackers to upload a PHP reverse shell and gain remote code execution.  
- **Evidence:**  
  ```http
  http://rootme.thm/uploads/shell.php5


Connected back to attacker as `www-data`.

* **Recommendation:**

  * Enforce strict server-side validation and allow only safe file types.
  * Disable execution permissions in upload directories.

---

### 2. Privilege Escalation via SUID Python (Critical)

* **Description:**
  `/usr/bin/python` was misconfigured with the SUID bit. This is uncommon and highly dangerous. Using GTFOBins techniques, it was possible to spawn a root shell.
* **Impact:**
  Complete system compromise (root).
* **Evidence:**

  ```bash
  /usr/bin/python -c 'import os; os.execl("/bin/sh", "sh", "-p")'
  ```

  Resulted in shell with `euid=0(root)`.
* **Recommendation:**

  * Remove SUID bit from `/usr/bin/python`.
  * Regularly audit SUID binaries with:

    ```bash
    find / -perm -4000 -type f
    ```

---

## Attack Path Summary

1. **Reconnaissance** – Nmap identified SSH and Apache.
2. **Web Discovery** – GoBuster revealed hidden directory `/panel/`.
3. **Initial Access** – File upload bypass using `.php5` → reverse shell as `www-data`.
4. **Privilege Escalation** – Misconfigured SUID Python → root shell.
5. **Objective Achieved** – Retrieved `/var/www/user.txt` and `/root/root.txt`.

---

## Flags Captured

* **User Flag:** `THM{y0u_g0t_a_sh3ll}`
* **Root Flag:** `THM{pr1v1l3g3_3sc4l4t10n}`

---

## Conclusion

The RootMe CTF highlights two critical security lessons:

* **File upload validation must be strict and paired with secure server configuration.**
* **SUID misconfigurations can give trivial paths to root.**

Both findings would be rated **Critical** in a real-world pentest, as they allow full compromise of confidentiality, integrity, and availability of the system.

---

## Remediation Summary

* Enforce **file upload whitelisting** and disable execution in `/uploads/`.
* Audit and **remove SUID from non-essential binaries** (e.g., Python).
* Implement continuous security monitoring and routine hardening checks.



